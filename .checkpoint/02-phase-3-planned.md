# Phase 3 계획된 작업들

## 날짜: 2025-01-09
## 상태: 📝 문서화/계획만 완료

## Phase 3.12: CLI 사용성 개선

### 현재 상태
- **문서화**: 완료 ✅
- **구현**: 부분 완료 (플래그 충돌만 해결)
- **진행률**: ~20%

### 완료된 작업 ✅
1. **CLI 디자인 가이드 작성**
   - `/docs/cli-design-guide/` (6개 파일)
   - 전체 아키텍처와 시스템 흐름
   - 명령어 구조와 패턴
   - 플래그 관리 시스템
   - 사용자 경험 가이드
   - 구현 템플릿과 패턴
   - 테스트 전략

2. **플래그 충돌 해결** (2025-01-09)
   - backup: `-t` → `-T` (--totals)
   - restore: `-o` → `-f` (--force)
   - restore: `-c` → `-C` (--container)
   - 코드 업데이트: backup.go, restore.go, restore_logic.go

### 미구현 항목 ❌
1. **플래그 레지스트리 시스템**
   - 중앙 집중식 플래그 관리
   - 컴파일 타임 충돌 검증
   - flags/registry.go 구현 필요

2. **CLIError 타입**
   - 구조화된 에러 처리
   - What, Why, How, SeeDoc 필드
   - 사용자 친화적 메시지

3. **하이브리드 인자 처리**
   - Positional args + flags 동시 지원
   - kubectl/docker 스타일 호환성

### 예상 복잡도
- 전체: 30/100
- 남은 작업: ~20/100

## Phase 3.13: 도구 자동 다운로드

### 현재 상태
- **문서화**: 완료 ✅
- **구현**: 0%
- **필요성**: 재검토 필요

### 목표
- kubectl, mc 등 외부 도구 자동 다운로드
- 시스템에 없을 때 투명한 설치

### 설계된 구조
```
internal/infrastructure/tools/
├── manager.go          # ToolManager 구현
├── kubectl.go          # kubectl 다운로드
├── mc.go              # MinIO client 다운로드
└── downloader.go      # 공통 다운로드 로직
```

### 주요 기능
1. **우선순위 검색**
   - 시스템 PATH 확인
   - ~/.cli-recover/tools/ 확인
   - 없으면 자동 다운로드

2. **안전한 다운로드**
   - HTTPS 전용
   - 임시파일 + rename
   - 플랫폼별 감지 (OS/아키텍처)

3. **캐싱 메커니즘**
   - 한 번 다운로드하면 재사용
   - 버전 관리 지원

### 예상 복잡도: 50/100
- ToolManager 구현: 20
- kubectl 지원: +15
- mc 지원: +10  
- 설정 통합: +5

### 재검토 필요 사항
1. **실제 필요성**
   - kubectl 없이 실행하는 경우가 많은가?
   - 복잡도 50은 과도하지 않은가?

2. **대안 검토**
   - 명확한 에러 메시지와 설치 가이드만으로 충분한가?
   - 사용자가 직접 설치하는 것이 더 안전한가?

## 우선순위 재평가

### 즉시 진행 가능 (낮은 복잡도)
1. **Phase 3.12 최소 구현**
   - CLIError 타입만 추가
   - 복잡한 레지스트리는 제외

### 재검토 필요 (높은 복잡도)
1. **Phase 3.13 전체**
   - 복잡도 50은 RULE_01 위반 가능성
   - 실제 사용자 요구 검증 필요

### 현재 권장 순서
1. 테스트 커버리지 90% 달성 (RULE_04)
2. Phase 3.12 최소 구현
3. Phase 3.13 필요성 재검토
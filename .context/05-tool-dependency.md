# 외부 도구 의존성 컨텍스트

## 프로젝트 내 위치
- CLI 도구들의 래퍼 역할
- kubectl, mc 등 외부 바이너리 실행
- Phase 3.13에서 자동 다운로드 계획

## 현재 의존성

### kubectl (구현됨)
- **용도**: Kubernetes 클러스터 상호작용
- **사용처**: 
  - Pod 목록 조회
  - 컨테이너 내 명령 실행
  - 파일시스템 백업/복원
- **필수성**: 핵심 기능에 필수

### mc - MinIO Client (계획됨)
- **용도**: S3 호환 객체 스토리지 접근
- **사용처**: 
  - 객체 스토리지 백업/복원
  - 버킷 관리
- **필수성**: 객체 스토리지 기능 사용 시 필수

## 의존성 관리 전략

### 현재 (Phase 3.11까지)
- 시스템 PATH에서 도구 검색
- 없으면 에러 발생
- 사용자가 수동 설치

### 계획 (Phase 3.13)
- 자동 감지 및 다운로드
- 로컬 캐싱 (~/.cli-recover/tools/)
- 투명한 사용자 경험

## 아키텍처 고려사항

### 분리 원칙
- 각 도구는 독립적 관리
- 인터페이스로 추상화
- 도구별 에러 처리

### 확장성
- 새 도구 추가 용이한 구조
- 플러그인 형태 고려 가능
- 버전 관리 전략 필요

### 보안
- 공식 소스에서만 다운로드
- HTTPS 전용
- 체크섬 검증 (선택사항)

## 복잡도 관리

### 허용 범위
- 단순 다운로드: ✅ (복잡도 50)
- 버전 관리: ⚠️ (복잡도 70)
- 자동 업데이트: ❌ (복잡도 90)

### Occam's Razor 적용
- 최소 기능으로 시작
- 실제 필요 시 확장
- 과도한 엔지니어링 회피

## 테스트 전략

### Mock 전략
- 도구 실행은 인터페이스로
- 테스트 시 Mock 구현 사용
- 실제 다운로드는 통합 테스트

### 격리
- 네트워크 의존 테스트 분리
- 로컬 파일시스템 테스트
- CI/CD 환경 고려

## 사용자 경험

### 투명성
- 자동 다운로드 시 알림
- 진행 상황 표시
- 실패 시 명확한 가이드

### 제어권
- 자동 다운로드 on/off 설정
- 도구 버전 지정 가능
- 수동 설치 경로 존중

## 향후 고려사항

### 컨테이너화
- 모든 도구 포함 이미지
- 복잡도 증가 vs 편의성
- 현재는 고려하지 않음

### 라이브러리화
- client-go 등 직접 사용
- 바이너리 의존성 제거
- 복잡도 대폭 증가로 보류
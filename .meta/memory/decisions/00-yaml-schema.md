# YAML 스키마 설계 결정

## 결정 일자: 2024-01-15

### 배경
- 프로젝트가 너무 복잡한 CRD 스타일로 가고 있었음
- 단순함과 확장성 사이의 균형이 필요
- Builder UI를 위한 명확한 데이터 흐름 필요

### 고려한 옵션들

#### 1. CRD 스타일 (Kubernetes 방식)
```yaml
apiVersion: cli-pipe/v1
kind: Pipeline
metadata:
  name: backup
spec:
  steps: [...]
```
- 장점: 체계적, 확장 가능
- 단점: 너무 복잡, 오버엔지니어링

#### 2. 자동 연결 방식
```yaml
steps:
  - echo "hello"
  - tr '[:lower:]' '[:upper:]'
```
- 장점: 매우 단순
- 단점: 분기나 재사용 어려움

#### 3. 입출력 명시 방식 (선택)
```yaml
steps:
  - name: extract
    run: tar cf - /data
    output: tar-stream
  - name: compress
    run: gzip -9
    input: tar-stream
    output: compressed
```
- 장점: 명확한 데이터 흐름, 적절한 복잡도
- 단점: 모든 입출력을 명시해야 함

### 최종 결정

**입출력 명시 방식**을 선택함.

이유:
1. 데이터 흐름이 명확함
2. DAG 구성이 쉬움
3. 디버깅이 용이함
4. Builder UI에서 시각화하기 좋음
5. 점진적으로 자동 연결 추가 가능

### 진화 계획

1. **v0.1**: 모든 입출력 명시 필수
2. **v0.2**: 변수 지원, 병렬 실행
3. **v1.0**: 선택적 자동 연결 추가

### 핵심 원칙

1. **명시성**: 암묵적인 것보다 명시적인 것이 낫다
2. **단순성**: 시작은 단순하게, 필요시 복잡도 추가
3. **일관성**: 모든 Step이 동일한 구조
4. **확장성**: 새로운 기능 추가가 쉬워야 함

### 영향

- 모든 문서가 입출력 기반으로 재작성됨
- 실행 엔진이 스트림 매니저 중심으로 설계됨
- 고루틴 기반 동시 실행이 자연스럽게 구현 가능
name: kubectl-backup-advanced
description: Comprehensive backup of multiple directories from vscode pod

steps:
  - name: backup-tmp
    run: kubectl exec vscode -- tar czf - /tmp
    output: file:backup-vscode-tmp-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: backup-etc-small
    run: kubectl exec vscode -- tar czf - /etc/passwd /etc/hosts /etc/hostname /etc/resolv.conf
    output: file:backup-vscode-etc-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: backup-var-log-recent
    run: kubectl exec vscode -- find /var/log -name "*.log" -mtime -1 | kubectl exec vscode -- tar czf - -T -
    output: file:backup-vscode-logs-$(date +%Y%m%d-%H%M%S).tar.gz
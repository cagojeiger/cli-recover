name: kubectl-lightweight-backup
description: Lightweight backup examples for small files and configurations

steps:
  - name: backup-small-tmp
    run: kubectl exec vscode -- tar czf - /tmp --exclude="*.log" --exclude="*.tmp" --exclude="core.*"
    output: file:backup-vscode-tmp-clean-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: backup-config-files
    run: kubectl exec vscode -- tar czf - /etc/passwd /etc/group /etc/hosts /etc/hostname /etc/resolv.conf
    output: file:backup-vscode-config-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: backup-recent-logs
    run: kubectl exec vscode -- find /var/log -name "*.log" -size -1M -mtime -1 | kubectl exec vscode -- tar czf - -T -
    output: file:backup-vscode-recent-logs-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: backup-proc-info
    run: kubectl exec vscode -- tar czf - /proc/version /proc/cpuinfo /proc/meminfo /proc/mounts
    output: file:backup-vscode-system-info-$(date +%Y%m%d-%H%M%S).tar.gz
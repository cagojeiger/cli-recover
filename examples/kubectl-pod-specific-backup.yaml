name: kubectl-pod-specific-backup
description: Backup from specific pod with namespace and pod name

steps:
  - name: backup-from-specific-pod
    run: kubectl exec -n default pod/vscode-deployment-67cb5dccf-t8ck7 -- tar czf - /tmp
    output: file:backup-$(kubectl get pod vscode-deployment-67cb5dccf-t8ck7 -o jsonpath='{.metadata.name}')-tmp-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: backup-with-pod-info
    run: |
      POD_NAME=$(kubectl get pods -l app=vscode -o jsonpath='{.items[0].metadata.name}')
      kubectl exec $POD_NAME -- tar czf - /var/log
    output: file:backup-vscode-logs-$(date +%Y%m%d-%H%M%S).tar.gz
    
  - name: small-config-backup
    run: kubectl exec vscode -- tar czf - /etc/hostname /etc/hosts /proc/version
    output: file:backup-vscode-$(kubectl exec vscode -- hostname)-config.tar